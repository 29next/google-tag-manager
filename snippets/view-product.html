{% if app.settings.google_tag_manager_enabled %}
{% purchase_info_for_product request product as session %}
<script>
    dataLayer.push({ ecommerce: null });
    dataLayer.push({
    'ecommerce': {
        'detail': {
        'products': [{
                'id': '{{ product.id|escapejs }}',
                'name': '{{ product.get_title|escapejs }}',
                'brand': '{{ store_name|escapejs }}',
                'category': '{{ product.categories.first.name|safe }}',
                'quantity': 1,
                'price': '{{ session.price.excl_tax }}'
            }]
        }
    }
    });
</script>
{% endif %}
